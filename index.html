


<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Welcome to pNNE &#8212; pNNE  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=364eaeb9" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=927b94d3fcb96560df09"></script>

    <script src="_static/documentation_options.js?v=8a448e45"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'index';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Welcome to pNNE" href="home/home.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
   

<a class="navbar-brand logo" href="https://pnnehome.github.io">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
    <p class="title logo__title">pNNE</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="home/home.html">
                         Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="code/code.html">
                         Code
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contact/contact.html">
                         Contact
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  

  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="home/home.html">
                         Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="code/code.html">
                         Code
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contact/contact.html">
                         Contact
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article"></div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
<section id="welcome-to-pnne">
<h1>Welcome to pNNE<a class="headerlink" href="#welcome-to-pnne" title="Link to this heading">#</a></h1>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>This website provides a pre-trained estimator for consumer search model.</p>
<p>The estimator is built as pNNE (pre-trained neural net estimator). The idea is to allocate the bulk of work to pre-training. So an end user can estimate the structural econometric model as easy as a reduced-form model.</p>
<p>Below is a brief overview how to apply pNNE to your search data. For Matlab code and description, go to <a class="reference internal" href="code/code.html#code"><span class="std std-ref">Code</span></a> page.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The main function to execute estimation is <code class="docutils literal notranslate"><span class="pre">nne_estimate.m</span></code>, as shown below.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">result = nne_estimate(nne, Y, Xp, Xa, Xc, consumer_idx)</span>
</pre></div>
</div>
<p>The inputs and output:</p>
<ul class="simple">
<li><p>Input <code class="docutils literal notranslate"><span class="pre">nne</span></code> stores the trained neural net and some pre-defined settings, available from the file <code class="docutils literal notranslate"><span class="pre">trained_nne.mat</span></code>;</p></li>
<li><p>Inputs <code class="docutils literal notranslate"><span class="pre">Xp</span></code>, <code class="docutils literal notranslate"><span class="pre">Xa</span></code>, <code class="docutils literal notranslate"><span class="pre">Xc</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span></code>, and <code class="docutils literal notranslate"><span class="pre">consumer_index</span></code> store your data.</p></li>
<li><p>Output <code class="docutils literal notranslate"><span class="pre">result</span></code> is a table storing the parameter estimate of a standard consumer search model.</p></li>
</ul>
<p>Below shows an example. The total execution time is 0.78 sec on a laptop, including overheads such as some data sanity checks.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;  load(&#39;trained_nne.mat&#39;, &#39;nne&#39;)</span>
<span class="go">&gt;&gt;  tic</span>
<span class="go">result = nne_estimate(nne, Y, Xp, Xa, Xc, consumer_idx);</span>
<span class="go">toc</span>
<span class="go">Elapsed time is 0.784314 seconds.</span>
<span class="go">&gt;&gt; result</span>
<span class="go">result = 8×2 table</span>
<span class="go">    name           val</span>
<span class="go"> ----------      -------</span>
<span class="go"> &quot;\alpha_0&quot;      -6.4546</span>
<span class="go"> &quot;\alpha_1&quot;     -0.11333</span>
<span class="go"> &quot;\eta_0&quot;          5.929</span>
<span class="go"> &quot;\eta_1&quot;      -0.048687</span>
<span class="go"> &quot;\eta_2&quot;        0.22004</span>
<span class="go"> &quot;\eta_3&quot;       0.052894</span>
<span class="go"> &quot;\beta_1&quot;       0.25836</span>
<span class="go"> &quot;\beta_2&quot;      -0.53811</span>
</pre></div>
</div>
<p>The rest of this page gives more details on the search model, how to format your data, and how to get standard errors.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<section id="the-search-model">
<h2>1) The search model<a class="headerlink" href="#the-search-model" title="Link to this heading">#</a></h2>
<p>The econometric model to be estimated is a standard sequential search model. Each consumer faces J products (or options). She decides which options to search and which option to buy. Searching a product incurs a search cost but also reveals some utility for the product.</p>
<p>A typical setting for the model is consumer search online, where a “consumer” is a “search session.” A consumer is shown a list of products. Clicking a product for more information is a search. After searching, the consumer may buy one product or an outside good. The list page usually shows some product attributes (e.g., review rating) that affect consumer utility for products. In addition, there may be some consumer attributes (e.g., past spending, visit time) that affect consumer outside utility. There may also be advertising attributes (e.g., ranking in the list) that affect search costs.</p>
<p>There are three sets of parameters: <span class="math notranslate nohighlight">\(\beta\)</span> describes how product attributes affect utility,  <span class="math notranslate nohighlight">\(\eta\)</span> describes how consumer attributes affect outside utility, and <span class="math notranslate nohighlight">\(\alpha\)</span> describes how advertising attributes affect search costs.</p>
<p>A free search is endowed, to accommodate most data where consumer searches at least once.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="data-format">
<h2>2) Data format<a class="headerlink" href="#data-format" title="Link to this heading">#</a></h2>
<p>Organize data into five arrays: <code class="docutils literal notranslate"><span class="pre">Xp</span></code>, <code class="docutils literal notranslate"><span class="pre">Xa</span></code>, <code class="docutils literal notranslate"><span class="pre">Xc</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span></code>, and <code class="docutils literal notranslate"><span class="pre">consumer_index</span></code>. Respectively: <code class="docutils literal notranslate"><span class="pre">Xp</span></code> stores product attributes; <code class="docutils literal notranslate"><span class="pre">Xa</span></code> stores advertising attributes; and <code class="docutils literal notranslate"><span class="pre">Xc</span></code> stores consumer attributes; <code class="docutils literal notranslate"><span class="pre">Y</span></code> stores search and purchase outcomes; <code class="docutils literal notranslate"><span class="pre">consumer_index</span></code> identifies consumers.</p>
<p>In the example below, there are n=10,000 consumers (or search sessions) and each consumer has J=20 options for search. There are 2 product attributes, 1 advertising attribute, and 3 consumer attributes.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;  whos Xp Xa Xc Y consumer_idx</span>

<span class="go">    Name               Size             Bytes         Class      Attributes</span>

<span class="go">    Xa                200000x1         1600000        double</span>
<span class="go">    Xc                 10000x3          240000        double</span>
<span class="go">    Xp                200000x2         3200000        double</span>
<span class="go">    consumer_idx      200000x1         1600000        double</span>
<span class="go">    Y                 200000x2         3200000        double</span>
</pre></div>
</div>
<p>Below previews the first rows of  <code class="docutils literal notranslate"><span class="pre">Xp</span></code>, <code class="docutils literal notranslate"><span class="pre">Xa</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span></code>, and <code class="docutils literal notranslate"><span class="pre">consumer_index</span></code>. Variable <code class="docutils literal notranslate"><span class="pre">Y</span></code> has two columns; the 1st column indicates search and 2nd column indicates purchase. We see that the first consumer searched option 1, 3, 4, and 8. She bought option 3.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;  table(consumer_idx, Y, Xp, Xa)</span>
<span class="go">ans = 200000×4 table</span>
<span class="go"> consumer_idx      Y             Xp          Xa</span>
<span class="go"> ____________    ______    ______________    __</span>
<span class="go">        1        1    0    4      0.67743    0</span>
<span class="go">        1        0    0    5       1.1052    0</span>
<span class="go">        1        1    1    1     -0.24542    0</span>
<span class="go">        1        1    0    5      0.78452    0</span>
<span class="go">        1        0    0    4      0.10519    0</span>
<span class="go">        1        0    0    5     0.068463    0</span>
<span class="go">        1        0    0    4      0.35691    1</span>
<span class="go">        1        1    0    5      0.61307    0</span>
<span class="go">        1        0    0    3       1.1809    1</span>
<span class="go">        1        0    0    5      0.91391    0</span>
<span class="go">        1        0    0    5     0.054537    0</span>
<span class="go">        1        0    0    3       1.0015    0</span>
<span class="go">        1        0    0    5      0.73938    0</span>
<span class="go">        1        0    0    3    -0.020808    0</span>
<span class="go">        1        0    0    5      0.23587    0</span>
<span class="go">        1        0    0    5      0.43236    1</span>
<span class="go">        1        0    0    5    -0.040968    0</span>
<span class="go">        1        0    0    5       0.4916    0</span>
<span class="go">        1        0    0    2      0.96498    0</span>
<span class="go">        1        0    0    2      0.46767    0</span>
<span class="go">        2        1    0    3      0.72159    1</span>
<span class="go">        2        0    0    5     -0.39847    0</span>
<span class="go">        2        0    0    5      0.73669    1</span>
<span class="go">      :            :             :           :</span>
</pre></div>
</div>
<p>Consumer attributes <code class="docutils literal notranslate"><span class="pre">Xc</span></code>, not displayed here, should have the same number of rows as the number of consumers (10,000 in this example).</p>
<p>If data did not feature advertising attributes, we’d let <code class="docutils literal notranslate"><span class="pre">Xa</span></code> be 200,000 by 0 (no columns). If data did not feature consumer attributes, we’d let <code class="docutils literal notranslate"><span class="pre">Xc</span></code> be 10,000 by 0.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="bootstrap-standard-errors">
<h2>3) Bootstrap standard errors<a class="headerlink" href="#bootstrap-standard-errors" title="Link to this heading">#</a></h2>
<p>The nne_estimate function has standard error calculation built in. Simply add <code class="docutils literal notranslate"><span class="pre">&quot;se</span> <span class="pre">=</span> <span class="pre">true&quot;</span></code> option as shown below. The output will include an additional column of standard errors. The calculation bootstraps 50 samples so execution time will be longer, but it can take advantage of parallel computing toolbox if installed.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt; result = nne_estimate(nne, Y, Xp, Xa, Xc, consumer_idx, se = true);</span>
<span class="go">&gt;&gt; result</span>
<span class="go">result = 8×3 table</span>

<span class="go">   name          val          se</span>
<span class="go">__________    _________    ________</span>
<span class="go">&quot;\alpha_0&quot;      -6.4546    0.071848</span>
<span class="go">&quot;\alpha_1&quot;     -0.11333    0.044997</span>
<span class="go">&quot;\eta_0&quot;          5.929    0.061318</span>
<span class="go">&quot;\eta_1&quot;      -0.048687    0.011513</span>
<span class="go">&quot;\eta_2&quot;        0.22004    0.029282</span>
<span class="go">&quot;\eta_3&quot;       0.052894    0.023437</span>
<span class="go">&quot;\beta_1&quot;       0.25836    0.004951</span>
<span class="go">&quot;\beta_2&quot;      -0.53811    0.011032</span>
</pre></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09"></script>

<footer class="bd-footer">
  <div class="bd-footer__inner bd-page-width">
    <div class="footer-items__start">    
        <div class="footer-item">
          <p>© Copyright 2023, <a href="https://sites.google.com/site/yanhaomaxwei/" target="_blank">Yanhao "Max" Wei</a>, 
                                <a href="https://jiangzhenling.com/" target="_blank">Zhenling Jiang </a>.</p>
    </div>                      
  </div>
</footer>

  </body>
</html>