


<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Welcome to Pre-trained NNE &#8212; pNNE  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=dcf890e0" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=927b94d3fcb96560df09"></script>

    <script src="_static/documentation_options.js?v=8a448e45"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'index';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="home/home.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
   

<a class="navbar-brand logo" href="https://pnnehome.github.io">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
    <p class="title logo__title">pre-trained NNE</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="home/home.html">
                         Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="code/code.html">
                         Code
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="data/data.html">
                         Data
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contact/contact.html">
                         Contact
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  

  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="home/home.html">
                         Home
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="code/code.html">
                         Code
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="data/data.html">
                         Data
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="contact/contact.html">
                         Contact
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article"></div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
<section id="welcome-to-pre-trained-nne">
<h1>Welcome to Pre-trained NNE<a class="headerlink" href="#welcome-to-pre-trained-nne" title="Link to this heading">#</a></h1>
<p>(<span class="note-text">Note: This website is still under construction. Last update on May 20, 2024.</span>)</p>
<p>This is the companion website for <a class="reference internal" href="#papers-home"><span class="std std-ref">Wei and Jiang (2024b)</span></a>. It provides a pre-trained estimator for a consumer search model used in economics &amp; marketing. It is based on a neural net that recognizes search model parameters from data patterns. We call it pre-trained neural net estimator (NNE). The approach extends <a class="reference internal" href="#papers-home"><span class="std std-ref">Wei and Jiang (2024a)</span></a> and is generally applicable to structural models. But here we focus on a consumer search model.</p>
<p>Below is a brief overview of applying pre-trained NNE to your search data. For Matlab code and documentation, see <a class="reference internal" href="code/code.html#code"><span class="std std-ref">code</span></a> page. For examples to try out, see <a class="reference internal" href="data/data.html#data"><span class="std std-ref">data</span></a> page.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>The main function to execute estimation is <code class="docutils literal notranslate"><span class="pre">nne_estimate.m</span></code>, as shown below.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">result = nne_estimate(nne, Y, Xp, Xa, Xc, consumer_idx)</span>
</pre></div>
</div>
<p>Explanation for inputs and output:</p>
<ul class="simple">
<li><p>Input <code class="docutils literal notranslate"><span class="pre">nne</span></code> stores the trained neural net and some pre-defined settings, available from the file <code class="docutils literal notranslate"><span class="pre">trained_nne.mat</span></code>.</p></li>
<li><p>Inputs <code class="docutils literal notranslate"><span class="pre">Xp</span></code>, <code class="docutils literal notranslate"><span class="pre">Xa</span></code>, <code class="docutils literal notranslate"><span class="pre">Xc</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span></code>, and <code class="docutils literal notranslate"><span class="pre">consumer_index</span></code> store your data (more on them below).</p></li>
<li><p>Output <code class="docutils literal notranslate"><span class="pre">result</span></code> is a table storing the parameter estimate for the search model.</p></li>
</ul>
<p>Below shows an example. The total execution time is 0.78 sec on a laptop. The time includes overheads such as some data sanity checks.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;  load(&#39;trained_nne.mat&#39;, &#39;nne&#39;)</span>
<span class="go">&gt;&gt;  tic</span>
<span class="go">result = nne_estimate(nne, Y, Xp, Xa, Xc, consumer_idx);</span>
<span class="go">toc</span>
<span class="go">Elapsed time is 0.784314 seconds.</span>
<span class="go">&gt;&gt; result</span>
<span class="go">result = 8×2 table</span>
<span class="go">    name           val</span>
<span class="go"> ----------      -------</span>
<span class="go"> &quot;\alpha_0&quot;      -6.4546</span>
<span class="go"> &quot;\alpha_1&quot;     -0.11333</span>
<span class="go"> &quot;\eta_0&quot;          5.929</span>
<span class="go"> &quot;\eta_1&quot;      -0.048687</span>
<span class="go"> &quot;\eta_2&quot;        0.22004</span>
<span class="go"> &quot;\eta_3&quot;       0.052894</span>
<span class="go"> &quot;\beta_1&quot;       0.25836</span>
<span class="go"> &quot;\beta_2&quot;      -0.53811</span>
</pre></div>
</div>
<p>The rest of this page gives more details on the search model, how to format your data, and how to get standard errors.</p>
<section id="the-search-model">
<h3>1) The search model<a class="headerlink" href="#the-search-model" title="Link to this heading">#</a></h3>
<p>Sequential search models have been commonly applied in economics &amp; marketing. A consumer faces <span class="math notranslate nohighlight">\(J\)</span> products (or options). She decides which options to search and which option to buy. Searching an option incurs a search cost but also reveals some utility for that option.  The search model estimated by the pre-trained NNE here is a standard one. The exact specification of it is given in <a class="reference internal" href="#papers-home"><span class="std std-ref">Wei and Jiang (2024b)</span></a>. Here we give a high-level description:</p>
<ul class="simple">
<li><p>A consumer searches and chooses among a list of products, plus an outside good. A free search is endowed (because in most data each consumer searches at least once).</p></li>
<li><p>The list shows some <strong>product attributes</strong> that affect consumer’s utility for products. The effects of these attributes are described by coefficients <span class="math notranslate nohighlight">\(\beta\)</span>.</p></li>
<li><p>There may be some <strong>consumer attributes</strong> that affect consumer’s outside utility. The effects of these attributes are described by coefficients <span class="math notranslate nohighlight">\(\eta\)</span>.</p></li>
<li><p>There may also be <strong>advertising attributes</strong> that affect search costs (but not utility). The effects of these attributes are described by coefficients <span class="math notranslate nohighlight">\(\alpha\)</span>.</p></li>
</ul>
<p>For a survey on empirical applications of search models, see <a class="reference internal" href="#papers-home"><span class="std std-ref">Ursu, Seiler, &amp; Honka (2022)</span></a>.</p>
</section>
<section id="data-format">
<h3>2) Data format<a class="headerlink" href="#data-format" title="Link to this heading">#</a></h3>
<p>To use the pre-trained NNE, organize data into five arrays: <code class="docutils literal notranslate"><span class="pre">Y</span></code>, <code class="docutils literal notranslate"><span class="pre">Xp</span></code>, <code class="docutils literal notranslate"><span class="pre">Xa</span></code>, <code class="docutils literal notranslate"><span class="pre">Xc</span></code>, and <code class="docutils literal notranslate"><span class="pre">consumer_index</span></code>. Respectively, they store search &amp; purchase outcomes, product attributes, advertising attributes, consumer attributes, and consumer identifiers.</p>
<p>Below, we illustrate with an example of shopping at an online retailer. There are <span class="math notranslate nohighlight">\(n\)</span> = 10,000 consumers and <span class="math notranslate nohighlight">\(J\)</span> = 15 options per consumer. Below shows a preview of the top rows of  <code class="docutils literal notranslate"><span class="pre">consumer_index</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span></code>, <code class="docutils literal notranslate"><span class="pre">Xp</span></code>, and <code class="docutils literal notranslate"><span class="pre">Xa</span></code>. Note there are <span class="math notranslate nohighlight">\(nJ\)</span> rows in total. We see:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">consumer_idx</span></code> is a column vector. Each value indicates the consumer.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Y</span></code> has two columns; the 1st column indicates search and 2nd column indicates purchase. In this example, we see the first consumer searched the 1st, 3rd, and 8th options. She bought the 3rd option.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Xp</span></code> stores product attributes. In this example, there are two product attributes: a 1-5 product rating and log price.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Xa</span></code> stores advertising attributes. In this example, there is one advertising attribute: whether the product is highlighted on the retailer website.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Xc</span></code> stores consumer attributes. It is not previewed below. It has only <span class="math notranslate nohighlight">\(n\)</span> rows, one for each consumer.</p></li>
</ul>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;  table(consumer_idx, Y, Xp, Xa)</span>
<span class="go">ans = 150000×4 table</span>
<span class="go"> consumer_idx      Y             Xp          Xa</span>
<span class="go"> ____________    ______    ______________    __</span>
<span class="go">        1        1    0    4      0.67743    1</span>
<span class="go">        1        0    0    5       1.1052    1</span>
<span class="go">        1        1    1    1     -0.24542    1</span>
<span class="go">        1        0    0    5      0.78452    0</span>
<span class="go">        1        0    0    4      0.10519    0</span>
<span class="go">        1        0    0    5     0.068463    0</span>
<span class="go">        1        0    0    4      0.35691    0</span>
<span class="go">        1        1    0    5      0.61307    0</span>
<span class="go">        1        0    0    3       1.1809    0</span>
<span class="go">        1        0    0    5      0.91391    0</span>
<span class="go">        1        0    0    5     0.054537    0</span>
<span class="go">        1        0    0    3       1.0015    0</span>
<span class="go">        1        0    0    5      0.73938    0</span>
<span class="go">        1        0    0    3    -0.020808    0</span>
<span class="go">        1        0    0    5      0.23587    0</span>
<span class="go">        2        0    0    3      0.72159    1</span>
<span class="go">        2        1    0    5     -0.39847    1</span>
<span class="go">        2        0    0    5      0.73669    1</span>
<span class="go">      :            :             :           :</span>
</pre></div>
</div>
<p>Below show the dimensions of each variable. Outside this example, if your data do not feature advertising or consumer attributes, you can let <code class="docutils literal notranslate"><span class="pre">Xa</span></code> or <code class="docutils literal notranslate"><span class="pre">Xc</span></code> be an empty matrix.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt;  whos Xp Xa Xc Y consumer_idx</span>

<span class="go">    Name               Size             Bytes         Class      Attributes</span>

<span class="go">    Xa                150000x1         1200000        double</span>
<span class="go">    Xc                 10000x3          240000        double</span>
<span class="go">    Xp                150000x2         2400000        double</span>
<span class="go">    consumer_idx      150000x1         1200000        double</span>
<span class="go">    Y                 150000x2         2400000        double</span>
</pre></div>
</div>
</section>
<section id="bootstrap-standard-errors">
<h3>3) Bootstrap standard errors<a class="headerlink" href="#bootstrap-standard-errors" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">nne_estimate.m</span></code> function has standard error calculation built in. Simply add <code class="docutils literal notranslate"><span class="pre">se</span> <span class="pre">=</span> <span class="pre">true</span></code> option as shown below. The output will include an additional column of standard errors. The calculation bootstraps 50 samples so execution time will be somewhat longer, but it can take advantage of parallel computing toolbox if installed.</p>
<p>We see <span class="math notranslate nohighlight">\(\alpha_1\)</span> is negative, indicating that the products highlighted by the retailer enjoy a lower search cost (so they are more likely to be searched). We see <span class="math notranslate nohighlight">\(\beta_1\)</span> is positive, indicating that consumer utility increases with product rating. We see <span class="math notranslate nohighlight">\(\eta_1\)</span> is negative, indicating that the outside utility decreases with the first consumer attribute.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt; result = nne_estimate(nne, Y, Xp, Xa, Xc, consumer_idx, se = true)</span>
<span class="go">result = 8×3 table</span>

<span class="go">   name          val          se</span>
<span class="go">__________    _________    ________</span>
<span class="go">&quot;\alpha_0&quot;      -6.4546    0.071848</span>
<span class="go">&quot;\alpha_1&quot;     -0.11333    0.044997</span>
<span class="go">&quot;\eta_0&quot;          5.929    0.061318</span>
<span class="go">&quot;\eta_1&quot;      -0.048687    0.011513</span>
<span class="go">&quot;\eta_2&quot;        0.22004    0.029282</span>
<span class="go">&quot;\eta_3&quot;       0.052894    0.023437</span>
<span class="go">&quot;\beta_1&quot;       0.25836    0.004951</span>
<span class="go">&quot;\beta_2&quot;      -0.53811    0.011032</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
</section>
<section id="papers">
<span id="papers-home"></span><h2>Papers<a class="headerlink" href="#papers" title="Link to this heading">#</a></h2>
<p>Wei, Yanhao ‘Max’ and Zhenling Jiang (2024a), “Estimating Parameters of Structural Models with Neural Networks,” Accepted at Marketing Science.</p>
<p>Wei, Yanhao ‘Max’ and Zhenling Jiang (2024b), “A Pre-trained Estimator for Consumer Search Models.”</p>
<p>Ursu, Raluca, Stephan Seiler, and Elisabeth Honka (2022), “The Sequential Search Model: A Framework for Empirical Research.”</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09"></script>

<footer class="bd-footer">
  <div class="bd-footer__inner bd-page-width">
    <div class="footer-items__start">    
        <div class="footer-item">
          <p>© Copyright 2023, <a href="https://sites.google.com/site/yanhaomaxwei/" target="_blank">Yanhao "Max" Wei</a>, 
                                <a href="https://jiangzhenling.com/" target="_blank">Zhenling Jiang </a>.</p>
    </div>                      
  </div>
</footer>

  </body>
</html>